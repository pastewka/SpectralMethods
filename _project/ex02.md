---
layout: default
title: "Üb. 2 [18. Dec.]"
parent: Übungsaufgaben
date: 2022-02-09
categories: homework
author: Lars Pastewka
nav_order: 2
---


<h2 class='chapterHead'><span class='titlemark'>Übungsblatt 2</span><br /><a id='x1-10002'></a>Grundlagen der Methode der finiten Elemente</h2>
<div class='framedenv' id='shaded*-1'>
<!-- l. 14 --><p class='noindent'><span class='underline'><span class='cmbx-12'>Anmerkung:</span></span> Die Abgabe von Arbeitsblatt 1 bis 4 ist verpflichtend und
konstituiert die Studienleistung der Veranstaltung Simulationstechniken.
Die Arbeitsblätter führen von der mathematischen Formulierung eines
Modellproblems hin zur numerischen Lösung dieses Problems und bauen
aufeinander auf. Zum Bestehen der Veranstaltung müssen auf jedem Blatt
mindestens 50% der erzielbaren Punkte erreicht werden.
</p><!-- l. 22 --><p class='indent'> Geben Sie bei allen Aufgaben die Lösungswege und Zwischenergebnisse mit
an. Das Endergebnis alleine ist nicht ausreichend! Wir empfehlen Ihnen die
Nutzung von Python. Sollten Sie ein Jupyter-Notebook verwenden, dann können
Sie dieses einfach direkt als Lösung bei uns einreichen. In allen anderen Fällen
erzeugen Sie bitte ein PDF und legen die numerischen Codes als separate Datei
dazu.
</p><!-- l. 29 --><p class='indent'> Sie werden durch die einzelnen Schritte der Modellimplementierung geleitet,
und wir geben Hinweise zur Implementierung. Es ist nicht zwingend notwendig,
diese 1-zu-1 zu verfolgen. Im Rahmen dieser Hinweise finden Sie Codeabschnitte,
die Sie verwenden können. Sie dürfen natürlich auch die Codebeispiele aus
dem Vorlesungsmaterial hier verwenden. </p></div>
<div class='framedenv' id='shaded*-1'>
<!-- l. 37 --><p class='noindent'><span class='underline'><span class='cmbx-12'>Anmerkung:</span></span> Hinweise zu den numerischen Aufgaben: </p>
<ul class='itemize1'>
<li class='itemize'>
<!-- l. 43 --><p class='noindent'>Codes sollten immer möglichst übersichtlich und leicht lesbar sein.
Beachten Sie insbesondere:
</p>
<ul class='itemize2'>
<li class='itemize'>Verwenden Sie Namen anstelle von Symbolen um Ihre Variablen
zu benennen, also z.Bsp. <span class='cmtt-12'>concentration </span>oder <span class='cmtt-12'>Konzentration</span>
anstelle von <span class='cmtt-12'>c</span>
</li>
<li class='itemize'>Nutzen Sie Suffixe, um die Dimensionen von Matrizen
und Vektoren zu beschreiben. <span class='cmtt-12'>concentration_x </span>bedeutet
beispielsweise, dass die Einträge im Vektor <span class='cmtt-12'>concentration </span>von
der Raumrichtung <span class='cmtt-12'>x </span>abhängen.
</li>
<li class='itemize'>Kommentieren Sie Ihren Code ausreichend!</li></ul>
</li>
<li class='itemize'>Verwenden Sie die <span class='cmtt-12'>numpy</span>-interne Funktion <a href='https://numpy.org/doc/stable/reference/generated/numpy.linalg.solve.html'><span class='cmtt-12'>numpy.linalg.solve</span></a> zum
Lösen von linearen Gleichungssystemen. Ein eigener Algorithmus zum
Lösen von Gleichungssystemen ist NICHT Teil dieses Übungsblatts.
</li>
<li class='itemize'>Folgende <span class='cmtt-12'>numpy</span>-Funktionen können (aber müssen nicht) hilfreich sein:
<a href='https://numpy.org/doc/stable/reference/generated/numpy.full.html'><span class='cmtt-12'>full</span></a>, <a href='https://numpy.org/doc/stable/reference/generated/numpy.linspace.html'><span class='cmtt-12'>linspace</span></a>, <a href='https://numpy.org/doc/stable/reference/generated/numpy.zeros.html'><span class='cmtt-12'>zeros</span></a>, <a href='https://numpy.org/doc/stable/reference/generated/numpy.eye.html'><span class='cmtt-12'>eye</span></a>, <a href='https://numpy.org/doc/stable/reference/generated/numpy.diag.html'><span class='cmtt-12'>diag</span></a>, <a href='https://numpy.org/doc/stable/reference/generated/numpy.maximum.html'><span class='cmtt-12'>maximum</span></a>.
</li>
<li class='itemize'>Eine vollständige Dokumentation der <span class='cmtt-12'>numpy</span>-Funktionen finden Sie auf
<a class='url' href='https://numpy.org/doc/stable/'><span class='cmtt-12'>https://numpy.org/doc/stable/</span></a>.
</li>
<li class='itemize'>Für die Erstellung der Plots können Sie beispielsweise <a href='https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.html'><span class='cmtt-12'>matplotlib.pyplot</span></a>
verwenden. Die Dokumentation von matplotlib und Anwendungsbeispiele
finden Sie auf <a class='url' href='https://matplotlib.org/index.html'><span class='cmtt-12'>https://matplotlib.org/index.html</span></a>.
</li>
<li class='itemize'>Beachten Sie bitte die <a href='https://imtek-simulation.github.io/Simulationstechniken/_notes/abbildungen.html'>Regeln zur Erstellung von Graphiken</a>!</li></ul>
</div>
<h3 class='sectionHead'><span class='titlemark'>2.1 </span> <a id='x1-20002.1'></a>Fourier-Basisfunktionen</h3>
<!-- l. 83 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>2.1.1 </span> <a id='x1-30002.1.1'></a>Orthogonalität der 1D-Fourier-Basisfunktionen</h4>
<!-- l. 84 --><p class='noindent'><span class='cmbx-12'>3 Punkte</span><br class='newline' />Auf Übungsblatt 1 haben Sie eine analytische Lösung der Diffusionsgleichung
mithilfe der eindimensionalen Fourier-Reihe bestimmt. Weisen Sie nach, dass
die Basisfunktionen dieser Fourier-Reihe eine orthogonale Basis bilden.
Das Skalarprodukt zweier \(L\)-periodischen Funktion sei dabei definiert als:
\begin {equation} \left ( f, g \right ) = \frac {1}{L} \int _0^L \dif x \, \left ( f^*(x) g(x) \right ) \end {equation}



wobei \(f^*(x)\) für das komplex-konjugierte von \(f(x)\) steht.
</p><!-- l. 137 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>2.1.2 </span> <a id='x1-40002.1.2'></a>Orthogonalität der 2D-Fourier-Basisfunktionen</h4>
<!-- l. 138 --><p class='noindent'><span class='cmbx-12'>3 Punkte</span><br class='newline' />Zeigen Sie, dass auch die Basisfunktionen der zweidimensionalen Fourier-Reihe
eine orthogonale Basis bilden. Das Skalarprodukt zweier Funktionen, die in
x-Richtung \(L_x\)-periodisch und in y-Richtung \(L_y\)-periodisch sind, sei dabei gegeben als \begin {equation} \left (f, g \right ) = \frac {1}{L_x L_y} \int _0^{L_y} \int _0^{L_x} \dif x \dif y \, \left ( f^*(x,y) g(x,y) \right ) \end {equation}
</p><!-- l. 183 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>2.1.3 </span> <a id='x1-50002.1.3'></a>Fourier-Koeffizienten </h4>
<!-- l. 184 --><p class='noindent'><span class='cmbx-12'>2 Punkte</span><br class='newline' />Leiten Sie die Formel für die Koeffizienten der zweidimensionalen Fourierreihe
her, indem Sie die Funktion \(f(x,y)\) auf die Fourierreihen-Basis projizieren.
</p><!-- l. 220 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>2.2 </span> <a id='x1-60002.2'></a>Finite-Elemente</h3>
<!-- l. 221 --><p class='noindent'>In dieser Aufgabe betrachten wir die Grundlagen der Finite Elemente Methode.
Als Beispielproblem nehmen wir die stationäre Diffusionsgleichung in 1D (Vgl.
Übungsblatt 1, Aufgabe 4): \begin {equation} D \frac {\partial ^2 c}{\partial x^2} = f(x) \label {eq:Diffusion} \end {equation}
Wie in Übungsblatt 1 ist dabei \(D\) die Diffusionskonstante, \(c(x)\) eine
Stoffmengenkonzentration und \(f(x)\) ein Quellterm. Die Gleichung gilt auf einem
endlichen Gebiet \([0; L]\).
</p><!-- l. 231 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>2.2.1 </span> <a id='x1-70002.2.1'></a>Diskretisierung für allgemeine Quellterme</h4>
<!-- l. 232 --><p class='noindent'><span class='cmbx-12'>5 Punkte</span><br class='newline' />Diskretisieren Sie Gleichung \eqref{eq:Diffusion} mithilfe von Finiten Elementen,
indem Sie zuerst die schwache Form herleiten und die Differenzierbarkeitsanforderung
verringern, dann den Galerkin-Ansatz wählen und zuletzt die gewählten
Basisfunktionen einsetzen. Die Gitterpunkte am Rand des Gebietes können Sie
dabei zunächst vernachlässigen.
</p><!-- l. 235 --><p class='indent'> Als Diskretisierung wollen wir \(N\) gleichmäßig verteilte Gitterpunkte verwenden.
Als Basisfunktionen wählen wir die stückweise linearen Zeltfunktionen, wie sie
in Abb. <a href='#x1-7001r1'>2.1<!-- tex4ht:ref: fig:hat_functions --></a> dargestellt sind.
</p>
<figure class='figure'>







<!-- l. 241 --><p class='noindent'><img alt='PIC' src='Hutfunktionen.svg' /> <a id='x1-7001r1'></a>
<a id='x1-7002'></a>
</p>
<figcaption class='caption'><span class='id'>Abbildung 2.1: </span><span class='content'>Hutfunktionen für \(N=4\) Gitterpunkte </span></figcaption><!-- tex4ht:label?: x1-7001r2.2 -->



</figure>
<h4 class='subsectionHead'><span class='titlemark'>2.2.2 </span> <a id='x1-80002.2.2'></a>Diskretisierung der Quellterme</h4>
<!-- l. 316 --><p class='noindent'><span class='cmbx-12'>2 Punkte</span><br class='newline' />Berechnen Sie nun die diskretisierten Terme der Quellterme aus der vorherigen
Aufgabe für die Quellterme:
</p><ol class='enumerate1'>
<li class='enumerate' id='x1-8002x1'>\(f(x) = -\delta \left (x - \frac {L}{3} \right ) / \mathrm {m}^3 \mathrm {s} + \delta \left (x - \frac {2L}{3} \right ) \mathrm {m}^{-3} \mathrm {s}^{-1}\)
</li>
<li class='enumerate' id='x1-8004x2'>\(f(x) = f_0\)</li></ol>
<div class='framedenv' id='shaded*-1'>
<!-- l. 323 --><p class='noindent'><span class='underline'><span class='cmbx-12'>Anmerkung:</span></span> Bitte beachten Sie bei Berechnung mit \(\delta \)-Distributionen als
Quellterm folgendes: </p>
<ul class='itemize1'>
<li class='itemize'>Um die Berechnung der diskretisierten Terme zu erleichtern, können
Sie die Anzahl an Gitterpunkte \(N\) immer so wählen, dass die dirac
Quellterme auf einem Knoten liegen, also \(N=3N'+1\) mit \(N' \in \mathbb {N}\).
</li>
<li class='itemize'>Die Delta-Distribution ist durch ihre Filter-Eigenschaft definiert: \(\int _0^L \dif x \, \delta (x-a) f(x) = f(a)\)</li></ul>
</div>



<!-- l. 386 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>2.3 </span> <a id='x1-90002.3'></a>Finite-Element im periodischen Raum</h3>
<!-- l. 388 --><p class='noindent'>In dieser Aufgabe wollen wir die Diffusionsgleichung mit periodischen
Randbedingungen auf dem Gebiet \([0;L]\), die in Übungsblatt 1, Aufgabe 4 analytisch
gelöst wurde mit Finiten Elementen lösen.
</p><!-- l. 392 --><p class='indent'> Dabei wählen wir die gleiche Diskretisierung und die gleichen Basisfunktionen
wie in Aufgabe 2.3. Genau wie bei der analytischen Lösung ist der Quellterm
\(f(x) = -\delta \left (x - \frac {L}{3} \right ) \mathrm {m}^{-3} \mathrm {s}^{-1} + \delta \left (x - \frac {2L}{3} \right ) \mathrm {m}^{-3} \mathrm {s}^{-1}\).
</p><!-- l. 397 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>2.3.1 </span> <a id='x1-100002.3.1'></a>Mittelwertbedingung</h4>
<!-- l. 398 --><p class='noindent'><span class='cmbx-12'>1 Punkte</span><br class='newline' />Wie wir auf dem Übungsblatt 1 gesehen haben, ist der Mittelwert der
Lösungsfunktion ohne weitere Angaben nicht bestimmbar. Anders gesagt, wenn \(c_1(x)\)
eine periodische Lösung der Diffusionsgleichung ist, dann ist \(c_2(x) = c_1(x) + \text {konst.}\) ebenfalls eine
periodische Lösung der Diffusionsgleichung. Diese Unendlichkeit an Lösungen
bedeutet, dass das Gleichungssystem, das wir mit den Finiten Elementen
aufstellen, nicht eindeutig lösbar ist.
</p><!-- l. 402 --><p class='indent'> Damit wir ein lösbares Gleichungssystem bekommen, brauchen wir
ein Problem mit einer eindeutigen Lösung. Wir müssen deshalb die
Forderung ‘periodische Randbedingungen’ mit einer weiteren Bedingung
ergänzen. Wir wählen dafür einen vorgegebenen Mittelwert von \(c_0\), d.h. \begin {equation} \frac {1}{L}\int _0^L \dif x \, c(x) = c_0 \end {equation}
</p><!-- l. 407 --><p class='indent'> Dadurch ergibt sich eine weitere Gleichung für die Koeffizienten \(a_i\). Stellen Sie
diese Gleichung auf.
</p><!-- l. 424 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>2.3.2 </span> <a id='x1-110002.3.2'></a>Systemmatrix</h4>
<!-- l. 425 --><p class='noindent'><span class='cmbx-12'>1 Punkte</span><br class='newline' />Das Gleichungssystem aus diskretisierten Gleichungen für die Koeffizienten \(a_i\) wird
üblicherweise in Matrix-Form geschrieben: \begin {equation} \underline {K} \cdot \overrightarrow {a} = \overrightarrow {f} \end {equation}
\(\underline {K}\) nennt man dann die Systemmatrix.



</p><!-- l. 432 --><p class='indent'> Stellen Sie die Systemmatrix für die Lösung der 1D-Diffusionsgleichung mit
periodischen Randbedingungen und einem vorgegebenen Mittelwert mithilfe von
lineare Finiten Elementen für 4 Gitterpunkte auf.
</p><!-- l. 492 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>2.3.3 </span> <a id='x1-120002.3.3'></a>Numerische Lösung</h4>
<!-- l. 493 --><p class='noindent'><span class='cmbx-12'>8 Punkte</span><br class='newline' />Schreiben Sie eine python-Funktion, um die Diffusionsgleichung im periodischen
Raum mit linearen Finiten Elementen zu lösen. Diese Funktion sollte als
Argumente die Anzahl der Gitterpunkte \(N\), den Abstand zwischen zwei
Gitterpunkten \(dx\) und einen Vektor mit der bereits diskretisierten rechten Seite des
Problems erwarten. Verwenden Sie also bitte die Schnittstelle:
</p>
<!-- l. 501 -->
<div class='lstlisting' id='listing-1'><span class='label'><a id='x1-12001r1'></a><span class='cmr-6'>1</span></span><span style='color:#FF00FF'><span class='cmtt-10'>def</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>fem_laplace_linear_1d_periodic</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>dx</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>rhs_x</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12002r2'></a><span class='cmr-6'>2</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12003r3'></a><span class='cmr-6'>3</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Function</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>to</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>solve</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>1</span></span><span style='color:#009900'><span class='cmtt-10'>D</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Laplace</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>equation</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>with</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>periodic</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12004r4'></a><span class='cmr-6'>4</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>boundary</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>conditions</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>and</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>an</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>imposed</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>average</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>using</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>a</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12005r5'></a><span class='cmr-6'>5</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>regular</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>and</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>linear</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>finite</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>elements</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12006r6'></a><span class='cmr-6'>6</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12007r7'></a><span class='cmr-6'>7</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Arguments</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12008r8'></a><span class='cmr-6'>8</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>---------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12009r9'></a><span class='cmr-6'>9</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>int</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12010r10'></a><span class='cmr-6'>10</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Number</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>points</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12011r11'></a><span class='cmr-6'>11</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>dx</span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12012r12'></a><span class='cmr-6'>12</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Length</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>between</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>two</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>adjacent</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>points</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12013r13'></a><span class='cmr-6'>13</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>rhs_x</span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>numpy</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>floats</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12014r14'></a><span class='cmr-6'>14</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Right</span></span><span style='color:#009900'><span class='cmtt-10'>-</span></span><span style='color:#009900'><span class='cmtt-10'>hand</span></span><span style='color:#009900'><span class='cmtt-10'>-</span></span><span style='color:#009900'><span class='cmtt-10'>side</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>vector</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12015r15'></a><span class='cmr-6'>15</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12016r16'></a><span class='cmr-6'>16</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Returns</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12017r17'></a><span class='cmr-6'>17</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>-------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12018r18'></a><span class='cmr-6'>18</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>func_x</span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>numpy</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>floats</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12019r19'></a><span class='cmr-6'>19</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Solution</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>discretized</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>1</span></span><span style='color:#009900'><span class='cmtt-10'>D</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Laplace</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>equation</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>at</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12020r20'></a><span class='cmr-6'>20</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>each</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>point</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12021r21'></a><span class='cmr-6'>21</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span></div>
<!-- l. 525 --><p class='indent'> Nutzen Sie Ihre Funktion, um einen Plot, zu erstellen, auf dem die
FEM-Lösung mit der analytischen Lösung verglichen wird. Auf dem Plot muss
zu sehen sein: </p>
<ul class='itemize1'>
<li class='itemize'>Analytische Lösung aus Übungsblatt 1, Aufgabe 4: \(c(x) = -\frac {1}{D}\max (0\mathrm {m}, x-L/3) \mathrm {m}^{-2} \mathrm {s}^{-1} + \frac {1}{D}\max (0\mathrm {m}, x-2L/3) \mathrm {m}^{-2} \mathrm {s}^{-1} + \frac {1}{3D} \mathrm {m}^{-2} \mathrm {s}^{-1} x + c_0\)
</li>
<li class='itemize'>Lösung mit FEM für N=4
</li>
<li class='itemize'>Lösung mit FEM für N=7</li></ul>
<!-- l. 533 --><p class='noindent'>Kommentieren Sie kurz, was man auf dem Plot beobachten kann. Was würden Sie
erwarten, wenn der Dirac-Impuls nicht direkt auf einem Gitterpunkt liegt? (Eine
Berechnung ist nicht nötig, ein kurzer Kommentar genügt.)
</p><!-- l. 537 --><p class='indent'> Verwenden Sie für den Plot folgende Werte für die Parameter: </p>



<ul class='itemize1'>
<li class='itemize'>\(D = 0.8 \mathrm {m}^{2} \mathrm {s}^{-1}\)
</li>
<li class='itemize'>\(L = 1.5\mathrm {m}\)
</li>
<li class='itemize'>\(1 / L \int _{0}^{L} \text {d}x\, c(x) = 0.3 \mathrm {m}^{-3}\)</li></ul>
<div class='framedenv' id='shaded*-1'>
<!-- l. 544 --><p class='noindent'><span class='underline'><span class='cmbx-12'>Anmerkung:</span></span> Beachten Sie bitte die Hinweise am Anfang des Übungsblattes! </p></div>
<!-- l. 575 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>2.4 </span> <a id='x1-130002.4'></a>Finite-Elemente mit Dirichlet- und Neumann-Randbedingungen</h3>
<!-- l. 577 --><p class='noindent'>In dieser Aufgabe betrachten wir die Diffusionsgleichung mit einer
Dirichlet-Randbedingung bei \(x=0\mathrm {m}\) und einer Neumann-Randbedingung bei \(x=L\): \begin {align} c(x=0) &amp;= c_0 \quad \text {(Dirichlet)}\\ \left .\frac {\partial c}{\partial x}\right \vert _{x=L} &amp;= c'_L \quad \text {(Neumann)} \end {align}
</p>
<figure class='figure'>







<!-- l. 586 --><p class='noindent'><img alt='PIC' src='openHalfspaceDiffusion1d.svg' /> <a id='x1-13001r2'></a>
<a id='x1-13002'></a>
</p>
<figcaption class='caption'><span class='id'>Abbildung 2.2: </span><span class='content'>openHalfspaceDiffusion1d </span></figcaption><!-- tex4ht:label?: x1-13001r2.4 -->



</figure>
<!-- l. 591 --><p class='indent'> Physikalisch entspricht dies einem System, dass auf der einen Seite an ein
unendliches Reservoir, in dem die Konzentration immer gleich bleibt,
angeschlossen ist, während auf der anderen Seite ein konstanter Teilchenstrom in
bzw. aus dem System fließt (vgl. Abb. <a href='#x1-13001r2'>2.2<!-- tex4ht:ref: fig:open_halfspace_diff --></a>).
</p><!-- l. 593 --><p class='indent'> Zur Lösung mit Finiten Elementen wählen wir die gleiche Diskretisierung
und die gleichen Basisfunktionen wie in Aufgabe 2.3.
</p>
<h4 class='subsectionHead'><span class='titlemark'>2.4.1 </span> <a id='x1-140002.4.1'></a>Randbedingungen</h4>
<!-- l. 596 --><p class='noindent'><span class='cmbx-12'>2 Punkte</span><br class='newline' />Stellen Sie die Gleichungen für die Koeffizienten \(a_i\) auf, die die Dirichlet und die
Neumann Randbedingungen beschreiben. Setzen Sie dabei für den Quellterm:
<br class='newline' />1. \(f(x) = -\delta \left (x - \frac {L}{3} \right ) \mathrm {m}^{-2} \mathrm {s}^{-1} + \delta \left (x - \frac {2L}{3} \right ) \mathrm {m}^{-2} \mathrm {s}^{-1}\) <br class='newline' />2. \(f(x) = f_0\)
</p><!-- l. 657 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>2.4.2 </span> <a id='x1-150002.4.2'></a>Numerische Lösung</h4>
<!-- l. 658 --><p class='noindent'><span class='cmbx-12'>10 Punkte</span><br class='newline' />Schreiben Sie eine python-Funktion, um die Diffusionsgleichung mit einer
Dirichlet- und einer Neumann-Randbedingung mit linearen Finiten Elementen zu
lösen. Diese Funktion sollte als Argumente die Anzahl der Gitterpunkte \(N\), den
Abstand zwischen zwei Gitterpunkten \(dx\) und einen Vektor mit der bereits
diskretisierten rechten Seite des Problems erwarten. Ein zusätzliches Argument
sollte angeben, ob die Systemmatrix zurückgegeben wird oder nicht. Verwenden
Sie also bitte die Schittstelle:
</p>
<!-- l. 662 -->
<div class='lstlisting' id='listing-2'><span class='label'><a id='x1-15001r1'></a><span class='cmr-6'>1</span></span><span style='color:#FF00FF'><span class='cmtt-10'>def</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>FEM_Laplace_Linear_1D</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>dx</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>rhs_x</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span style='color:#000000'><span class='cmtt-10'>:</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15002r2'></a><span class='cmr-6'>2</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15003r3'></a><span class='cmr-6'>3</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Function</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>to</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>solve</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>1</span></span><span style='color:#009900'><span class='cmtt-10'>D</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Laplace</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>equation</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>with</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>a</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15004r4'></a><span class='cmr-6'>4</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Dirichlet</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>boundary</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>condition</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>and</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>a</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Neumann</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>boundary</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15005r5'></a><span class='cmr-6'>5</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>condition</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>using</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>a</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>regular</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>and</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>linear</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>finite</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15006r6'></a><span class='cmr-6'>6</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>elements</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15007r7'></a><span class='cmr-6'>7</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15008r8'></a><span class='cmr-6'>8</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Arguments</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15009r9'></a><span class='cmr-6'>9</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>---------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15010r10'></a><span class='cmr-6'>10</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>int</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15011r11'></a><span class='cmr-6'>11</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Number</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>points</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15012r12'></a><span class='cmr-6'>12</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>dx</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15013r13'></a><span class='cmr-6'>13</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Length</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>between</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>two</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>adjacent</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>points</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15014r14'></a><span class='cmr-6'>14</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>rhs_x</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>numpy</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>floats</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15015r15'></a><span class='cmr-6'>15</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Right</span></span><span style='color:#009900'><span class='cmtt-10'>-</span></span><span style='color:#009900'><span class='cmtt-10'>hand</span></span><span style='color:#009900'><span class='cmtt-10'>-</span></span><span style='color:#009900'><span class='cmtt-10'>side</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>vector</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15016r16'></a><span class='cmr-6'>16</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>return_system_matrix</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>bool</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>optional</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15017r17'></a><span class='cmr-6'>17</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>True</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>if</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>system</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>matrix</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>should</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>be</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>returned</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15018r18'></a><span class='cmr-6'>18</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>Default</span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>False</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15019r19'></a><span class='cmr-6'>19</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15020r20'></a><span class='cmr-6'>20</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Returns</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15021r21'></a><span class='cmr-6'>21</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>-------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15022r22'></a><span class='cmr-6'>22</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>func_x</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>numpy</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>floats</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15023r23'></a><span class='cmr-6'>23</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Solution</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>discretized</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>problem</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>at</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>each</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>grid</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15024r24'></a><span class='cmr-6'>24</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>point</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15025r25'></a><span class='cmr-6'>25</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>system_matrix_xx</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>numpy</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'>((</span></span><span style='color:#009900'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>floats</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15026r26'></a><span class='cmr-6'>26</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>System</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>matrix</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>discretized</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>problem</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Is</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>only</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15027r27'></a><span class='cmr-6'>27</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>returned</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>if</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>argument</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>return_system_matrix</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>is</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15028r28'></a><span class='cmr-6'>28</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>True</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-15029r29'></a><span class='cmr-6'>29</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span></div>
<!-- l. 694 --><p class='indent'> Nutzen Sie Ihre Funktion, um 2 Plots zu erstellen, auf denen Folgendes
dargestellt wird: </p>
<ul class='itemize1'>



<li class='itemize'>Lösung der Diffusionsgleichung mit zwei Delta-Distributionen als
Quellterm: FEM-Lösung für \(N=4\), \(N=7\) und \(N=10\) darstellen.
</li>
<li class='itemize'>Lösung der Diffusionsgleichung mit konstantem Quellterm:
FEM-Lösung für \(N=4\), \(N=7\) und \(N=10\) sowie die analytische Lösung</li></ul>
<!-- l. 703 --><p class='noindent'>Kommentieren Sie jeweils kurz, was auf den Plots zu beobachten ist.
</p><!-- l. 705 --><p class='indent'> Verwenden Sie folgende Werte für die Parameter: </p>
<ul class='itemize1'>
<li class='itemize'>\(D = 0.8\frac {\mathrm {m}^2}{\mathrm {s}}\)
</li>
<li class='itemize'>\(L = 3\mathrm {m}\)
</li>
<li class='itemize'>\(c_0 = 2\mathrm {m}^{-3}\)
</li>
<li class='itemize'>\(c'_L = 0.7\mathrm {m}^{-4}\)
</li>
<li class='itemize'>\(f_0 = 0.5\mathrm {m}^{-3}\mathrm {s}^{-1}\)</li></ul>
<div class='framedenv' id='shaded*-1'>
<!-- l. 714 --><p class='noindent'><span class='underline'><span class='cmbx-12'>Anmerkung:</span></span> Die analytische Lösung können Sie durch Integration
bestimmen. </p></div>



<!-- l. 747 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>2.5 </span> <a id='x1-160002.5'></a>Finite-Elemente Lösung der linearisierten Poisson-Boltzmann
Gleichung</h3>
<!-- l. 749 --><p class='noindent'>Nachdem wir die Grundlagen der FEM betrachtet haben, wollen wir
jetzt zu unserem Modell-Problem zurückkehren und die linearisierte
Poisson-Boltzmann-Gleichung für den symmetrischen Elektrolyten in 1D
lösen, die in Übungsblatt 1, Aufgabe 7 hergeleitet wurde. In 1D lautet sie
\begin {equation} \frac {\partial ^2 \Phi (x)}{\partial x^2} = \frac {2 c^{\infty } q^2}{\varepsilon k_B T} \Phi (x) = \lambda ^{-2} \Phi (x) \, \text {,} \label {eq:A5_Poisson_Boltzmann} \end {equation}
wobei \(\Phi (x)\) das elektrostatische Potential, \(\varepsilon \) die Permittivität, \(k_B\) die Boltzmann-Konstante,
\(q\) der Ladungsbetrag der betrachteten Ionen, \(T\) die Temperatur, \(c^{\infty }\) die
Referenzkonzentration der Ionen und \(\lambda \) die Debye-Länge ist.
</p><!-- l. 757 --><p class='indent'> Wir betrachten die Gleichung auf einem endlichen Gebiet \([0; L]\). An den
Rändern von diesem Gebiet befinden sich zwei inerte Elektroden mit
elektrostatischem Potential \(\Phi _0\) und \(\Phi _1\), bei dem System könnte es sich also um einen
Plattenkondensator handeln (vgl. Abbildung)
</p>
<figure class='figure'>







<!-- l. 761 --><p class='noindent'><img alt='PIC' src='electrochemicalCell1dLinearizedPB.svg' /> <a id='x1-16001r3'></a>
<a id='x1-16002'></a>
</p>
<figcaption class='caption'><span class='id'>Abbildung 2.3: </span><span class='content'>Modell eines Plattenkondensators </span></figcaption><!-- tex4ht:label?: x1-16001r2.5 -->



</figure>
<h4 class='subsectionHead'><span class='titlemark'>2.5.1 </span> <a id='x1-170002.5.1'></a>Diskretisierung</h4>
<!-- l. 767 --><p class='noindent'><span class='cmbx-12'>6 Punkte</span><br class='newline' />Diskretisieren Sie Gleichung \eqref{eq:A5˙Poisson˙Boltzmann} mithilfe von
Finiten Elementen, indem Sie zuerst die schwache Form herleiten und die
Differenzierbarkeitsanforderung verringern, dann den Galerkin-Ansatz wählen
und zuletzt die gewählten Basisfunktionen einsetzen.
</p><!-- l. 770 --><p class='indent'> Verwenden Sie die gleichen Basisfunktionen wie in Aufgabe 2 - 4.
</p><!-- l. 832 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>2.5.2 </span> <a id='x1-180002.5.2'></a>Numerische Lösung</h4>
<!-- l. 833 --><p class='noindent'><span class='cmbx-12'>7 Punkte</span><br class='newline' />Schreiben Sie eine python-Funktion, um die 1D-Poisson-Boltzmann Gleichung mit
zwei Dirichlet-Randbedingungen mit linearen Finiten Elementen zu lösen. Diese
Funktion sollte als Argumente die Anzahl der Gitterpunkte \(N\), den Abstand
zwischen zwei Gitterpunkten \(l\), die Debye-Länge \(\lambda = \sqrt \frac {\varepsilon k_B T}{2 c^\infty q^2}\) und einen Vektor mit der
bereits diskretisierten rechten Seite des Problems nehmen. Verwenden Sie also die
Schnittstelle:
</p>
<!-- l. 837 -->
<div class='lstlisting' id='listing-3'><span class='label'><a id='x1-18001r1'></a><span class='cmr-6'>1</span></span><span style='color:#FF00FF'><span class='cmtt-10'>def</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>FEM_Poisson_Boltzmann_1D</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>dx</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>debye_length</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18002r2'></a><span class='cmr-6'>2</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>rhs_x</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span style='color:#000000'><span class='cmtt-10'>:</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18003r3'></a><span class='cmr-6'>3</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18004r4'></a><span class='cmr-6'>4</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Function</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>to</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>solve</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>1</span></span><span style='color:#009900'><span class='cmtt-10'>D</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Poisson</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Boltzmann</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>equation</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>with</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18005r5'></a><span class='cmr-6'>5</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>two</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Dirichlet</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>boundary</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>conditions</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>using</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>a</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>regular</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>grid</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18006r6'></a><span class='cmr-6'>6</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>and</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>linear</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>finite</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>elements</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18007r7'></a><span class='cmr-6'>7</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18008r8'></a><span class='cmr-6'>8</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Arguments</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18009r9'></a><span class='cmr-6'>9</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>---------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18010r10'></a><span class='cmr-6'>10</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>int</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18011r11'></a><span class='cmr-6'>11</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Number</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>points</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18012r12'></a><span class='cmr-6'>12</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>dx</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18013r13'></a><span class='cmr-6'>13</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Length</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>between</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>two</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>adjacent</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>points</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18014r14'></a><span class='cmr-6'>14</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>debye_length</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18015r15'></a><span class='cmr-6'>15</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Debye</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>length</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18016r16'></a><span class='cmr-6'>16</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>rhs_x</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>numpy</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>floats</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18017r17'></a><span class='cmr-6'>17</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Right</span></span><span style='color:#009900'><span class='cmtt-10'>-</span></span><span style='color:#009900'><span class='cmtt-10'>hand</span></span><span style='color:#009900'><span class='cmtt-10'>-</span></span><span style='color:#009900'><span class='cmtt-10'>side</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>vector</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18018r18'></a><span class='cmr-6'>18</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18019r19'></a><span class='cmr-6'>19</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Returns</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18020r20'></a><span class='cmr-6'>20</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>-------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18021r21'></a><span class='cmr-6'>21</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>func_x</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>numpy</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_grid_pts</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>floats</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18022r22'></a><span class='cmr-6'>22</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Solution</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>discretized</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>problem</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>at</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>each</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>point</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-18023r23'></a><span class='cmr-6'>23</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span></div>
<!-- l. 863 --><p class='indent'> Nutzen Sie Ihre Funktion, um einen Plot mit der Lösung der
1D-Poisson-Boltzmann Gleichung zu erstellen. Der Plot sollte enthalten:
</p>
<ul class='itemize1'>
<li class='itemize'>Analytische Lösung aus Übungsblatt 1, Aufgabe 7: \begin {equation} \Phi (x) = K_1 \exp {\left ( \frac {1}{\lambda }x\right )} + K_2\exp {\left ( -\frac {1}{\lambda }x\right )} \end {equation}
mit \(K_1 = \left ( \Phi _1 - \Phi _0 \exp {\left ( -\frac {L}{\lambda }\right )}\right )\left ( \exp {\left ( \frac {L}{\lambda }\right )} - \exp {\left ( -\frac {L}{\lambda }\right )} \right )^{-1}\) und \(K_2 = \Phi _0 - K_1\)
</li>
<li class='itemize'>FEM Lösung für N=4



</li>
<li class='itemize'>FEM Lösung für N=8
</li>
<li class='itemize'>FEM Lösung für N=16</li></ul>
<!-- l. 876 --><p class='indent'> Verwenden Sie folgende Werte für die Parameter: </p>
<ul class='itemize1'>
<li class='itemize'>\(L = 3 \mathrm {nm}\)
</li>
<li class='itemize'>\(\Phi _0 = -0.01 \mathrm {V}\)
</li>
<li class='itemize'>\(\Phi _1 = 0.04 \mathrm {V}\)
</li>
<li class='itemize'>\(c^{\infty } = 10^{3}\mathrm {mol}\, \mathrm {m}^{-3}\)
</li>
<li class='itemize'>\(q = e = 1.602\cdot 10^{-19}\mathrm {A} \mathrm {s}\)
</li>
<li class='itemize'>\(\varepsilon = 80 \cdot 8.85\cdot 10^{-12}\mathrm {A} \, \mathrm {s} \, \mathrm {V}^{-1} \, \mathrm {m}^{-1}\)
</li>
<li class='itemize'>\(k_B = 1.380649\cdot 10^{-23} \mathrm {J} \, \mathrm {K}^{-1}\)
</li>
<li class='itemize'>\(T = 293.15 \mathrm {K}\)



</li>
<li class='itemize'>Avogrado-Zahl \(N_A = 6.022\cdot 10^{23}\)</li></ul>

