---
layout: default
title: "Üb. 4 (Zeitpropagation) [20. Feb.]"
parent: Übungsaufgaben
date: 2022-02-09
categories: homework
author: Lars Pastewka
nav_order: 4
---

<h2 class='chapterHead'><span class='titlemark'>Übungsblatt 4</span><br /><a id='x1-10004'></a>Zeitpropagation</h2>
<div class='framedenv' id='shaded*-1'>
<!-- l. 12 --><p class='noindent'><span class='underline'><span class='cmbx-12'>Anmerkung:</span></span> Die Abgabe von Arbeitsblatt 1 bis 4 ist verpflichtend und
konstituiert die Studienleistung der Veranstaltung Simulationstechniken.
Die Arbeitsblätter führen von der mathematischen Formulierung eines
Modellproblems hin zur numerischen Lösung dieses Problems und bauen
aufeinander auf. Zum Bestehen der Veranstaltung müssen auf jedem Blatt
mindestens 50% der erzielbaren Punkte erreicht werden.
</p><!-- l. 20 --><p class='indent'> Geben Sie bei allen Aufgaben die Lösungswege und Zwischenergebnisse mit
an. Das Endergebnis alleine ist nicht ausreichend! Wir empfehlen Ihnen die
Nutzung von Python. Sollten Sie ein Jupyter-Notebook verwenden, dann können
Sie dieses einfach direkt als Lösung bei uns einreichen. In allen anderen Fällen
erzeugen Sie bitte ein PDF und legen die numerischen Codes als separate Datei
dazu.
</p><!-- l. 22 --><p class='indent'> Sie werden durch die einzelnen Schritte der Modellimplementierung geleitet,
und wir geben Hinweise zur Implementierung. Es ist nicht zwingend notwendig,
diese 1-zu-1 zu verfolgen. Im Rahmen dieser Hinweise finden Sie Codeabschnitte,
die Sie verwenden können. Sie dürfen natürlich auch die Codebeispiele aus
dem Vorlesungsmaterial hier verwenden. </p></div>
<h3 class='sectionHead'><span class='titlemark'>4.1 </span> <a id='x1-20004.1'></a>Zeitpropagation der Poisson-Nernst-Planck-Gleichung: Einführung</h3>
<!-- l. 32 --><p class='noindent'><span class='cmbx-12'>0 Punkte</span><br class='newline' />
</p><!-- l. 34 --><p class='indent'> Die (nichtlineare) Poisson-Boltzmann-Gleichung entspricht der
Poisson-Nernst-Planck (PNP) Gleichungen im thermodynamischen
Gleichgewicht. Falls die Ionenstromdichte nicht verschwindet, müssen wir die
Poisson-Nernst-Planck-Gleichungen betrachten. Wir betrachten hier die in
Übungsblatt 3, Aufgabe 1 hergeleitete entdimensionalisierte Variante dieser
Gleichung. Nutzen Sie im folgenden zwei Ionenspezies \(\alpha =+\) und \(\alpha =-\), mit den
(entdimensionalisierten) Ladungen \(q_+=+1\) und \(q_-=-1\).
</p><!-- l. 36 --><p class='indent'> In dieser Aufgabe wollen wir uns für ein eindimensionales Problem die
zeitliche Entwicklung der Ionenkonzentrationen nach einem gegebenen
Anfangszustand anschauen. Die Anwendung, welche wir hier diskutieren, ist ein
elektrochemischer Kondensator mit zwei parallelen Platten. Durch die Lösung
der PNP Gleichungen erhalten wir hier die Ladung als eine Funktion des
Potentials. Da diese Lösung die komplette zeitliche Entwicklung der
Ionenkonzentration beschreibt, können wir nun auch schauen, wir sich das



System bei einer Anregung verhält, die sich zeitlich ändert. Hiermit werden wir
in der Lage sein, Strom-Spannungskennlinien zu berechnen. In der Elektrochemie
werden solche Kennlinien oft in Form von <a href='https://de.wikipedia.org/wiki/Cyclovoltammetrie'><span class='cmtt-12'>Cylcovoltammogrammen</span></a> aufgenommen.
Die hier berechneten Cyclovoltammogramme werden keine <span class='cmti-12'>Faradayschen Prozesse</span>,
also chemische Reaktion an der Elektrode, berücksichtigen, beschreiben aber die
Dynamik der Ladungsumordnung.
</p><!-- l. 38 --><p class='indent'> Für gegebene Randbedingungen und Anfangskonzentrationen \(c_s(x, t=0)\) wollen wir die
Konzentrationen \(c_s(x, t)\) berechnen. Dafür werden wir die Nernst-Planck Gleichung
mithilfe des Runge-Kutta-Verfahrens zeitlich integrieren. Aber zunächst wollen
wir uns mit der räumlichen Diskretisierung mittels der Finite-Elemente-Methode
(FEM) beschäftigen.
</p><!-- l. 41 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>4.2 </span> <a id='x1-30004.2'></a>Diskretisierung mit Hilfe der finite-Elemente Methode</h3>
<!-- l. 42 --><p class='noindent'><span class='cmbx-12'>6 Punkte</span><br class='newline' />
</p><!-- l. 44 --><p class='indent'> Benutzen Sie die FEM um die PNP Gleichungen in ein Gleichungssystem in \(\dot c_{\alpha i}\), \(c_{\alpha i}\)
und \(\Phi _{j}\) zu Überführen. Benutzen Sie hierfür eindimensionale lineare Basisfunktionen.
Die Ansatzfunktionen haben nun zeitabhängige Entwicklungskoeffizienten, \begin {align} c_\alpha (x, t) &amp;= \sum _i c_{\alpha i}(t) \varphi _i(x) \\ \Phi (x, t) &amp;= \sum _j \Phi _j(t) \varphi _j(x), \end {align}
</p><!-- l. 49 --><p class='indent'> und wir nutzen die gleiche Basis für alle drei Felder.
</p><!-- l. 51 --><p class='indent'> Diese drei konstituierenden Gleichungen können einzeln diskretisiert
werden. Sie koppeln über das elektrostatische Potential \(\Phi \). An den Rändern
mit Neumann-Randbedingungen werden Gradienten oder Flüße in den
hier betrachteten Beispielen immer verschwinden, d.h. Sie können die
entsprechenden Terme frühzeitig auslassen. Bitte arbeiten Sie ab hier
mit der eindimensionalen Variante der PNP-Gleichungen. Rechnen Sie
die Integrale zunächst nicht explizit aus, aber ersetzen Sie diese durch
Symbole.
</p><!-- l. 53 --><p class='indent'> Sie sollten ein System der Form \begin {align} \label {eq:pnp-discrete-system-1-p} \sum _j L_{ij} \Phi _j &amp;= \frac {1}{2} \sum _j M_{ij}\left (q_+c_{+j} + q_-c_{-j}\right ) \\ \sum _j M_{ij} \dot c_{\alpha j} &amp;= -\sum _j L_{ij} c_{\alpha j} - q_\alpha \sum _{jk} C_{ijk} c_{\alpha j} \Phi _k \label {eq:pnp-discrete-system-1-np} \end {align}
</p><!-- l. 60 --><p class='indent'> erhalten. Wir haben hier die homogenen Neumann-Terme weggelassen. Welche
Schwierigkeiten erwarten Sie?



</p><!-- l. 154 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>4.3 </span> <a id='x1-40004.3'></a>Berechnung der Basisfunktionsintegrale</h3>
<!-- l. 155 --><p class='noindent'><span class='cmbx-12'>6 Punkte</span><br class='newline' />
</p><!-- l. 157 --><p class='indent'> Bitte verwenden Sie nun ein reguläres Gitter (konstanter Abstand \(\Delta x\)) mit
linearen finiten Elementen wie in der Vorlesung vorgestellt. Rechnen Sie nun die
Integrale \(L_{ij}\), \(M_{ij}\) und \(C_{ijk}\) explizit aus. Einige dieser Integrale sind schon in der Vorlesung
und auf vorherigen Übungsblättern aufgetaucht. Zum Berechnen der Integrale
können Sie natürlich ein Computeralgebrasystem (wie z.B. Mathematica oder
<a href='https://sympy.org'><span class='cmtt-12'>sympy</span></a>) benutzen.
</p><!-- l. 160 --><p class='indent'> <span class='cmti-12'>Achtung</span>: Beachten Sie, dass die Integrale am Rand des Gebiets anders
aussehen als in der Mitte.
</p><!-- l. 226 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>4.4 </span> <a id='x1-50004.4'></a>Implementierung der Gleichungssysteme</h3>
<!-- l. 227 --><p class='noindent'><span class='cmbx-12'>0 Punkte</span><br class='newline' />
</p><!-- l. 229 --><p class='indent'> Implementieren Sie nun die linken und rechten Seiten der Gleichungen
\eqref{eq:pnp-discrete-system-1-p} und \eqref{eq:pnp-discrete-system-1-np}. Wir
schlagen die unten genannten Funktionsnamen und Funktionssignaturen
vor.
</p>
<div class='framedenv' id='shaded*-1'>
<!-- l. 231 --><p class='noindent'><span class='underline'><span class='cmbx-12'>Anmerkung:</span></span> Sie brauchen einige der auftretenden Matrizen nicht explizit
berechnen. Beispielsweise können Sie anstelle \(\underline {C}\) konkret aufzustellen, auch nur die
Auswirkung von \(\underline {C}\) auf einen Vektor implementieren. Dies führt zu erheblich
kompakterem Code. Der Grund dafür ist, dass wir bei der expliziten
Zeitpropagation im Gegensatz zu den vorher behandelten ˙impliziten˙ Methoden
nicht explizit ein lineares Gleichungssystem lösen müssen. (Achtung: \(\underline {M}\) müssen
Sie explizit als Matrix berechnen! Für die Lösung der Poisson-Gleichung
brauchen Sie auch \(\underline {L}\) explizit als Matrix!) </p></div>
<!-- l. 235 -->
<div class='lstlisting' id='listing-1'><span class='label'><a id='x1-5001r1'></a><span class='cmr-6'>1</span></span><span style='color:#FF00FF'><span class='cmtt-10'>def</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>laplacian</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>dx</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span style='color:#000000'><span class='cmtt-10'>:</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5002r2'></a><span class='cmr-6'>2</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5003r3'></a><span class='cmr-6'>3</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Return</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Laplace</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>operator</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>L_</span></span><span style='color:#009900'><span class='cmtt-10'>{</span></span><span style='color:#009900'><span class='cmtt-10'>ij</span></span><span style='color:#009900'><span class='cmtt-10'>}</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5004r4'></a><span class='cmr-6'>4</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5005r5'></a><span class='cmr-6'>5</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Parameters</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5006r6'></a><span class='cmr-6'>6</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>----------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5007r7'></a><span class='cmr-6'>7</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>int</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5008r8'></a><span class='cmr-6'>8</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Number</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nodes</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5009r9'></a><span class='cmr-6'>9</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>dx</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5010r10'></a><span class='cmr-6'>10</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>spacing</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5011r11'></a><span class='cmr-6'>11</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5012r12'></a><span class='cmr-6'>12</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Returns</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5013r13'></a><span class='cmr-6'>13</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>-------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5014r14'></a><span class='cmr-6'>14</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>laplacian_gg</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>np</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>shape</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5015r15'></a><span class='cmr-6'>15</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Matrix</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>containing</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>laplacian</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>matrix</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5016r16'></a><span class='cmr-6'>16</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5017r17'></a><span class='cmr-6'>17</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#FF00FF'><span class='cmtt-10'>pass</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5018r18'></a><span class='cmr-6'>18</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5019r19'></a><span class='cmr-6'>19</span></span><span style='color:#FF00FF'><span class='cmtt-10'>def</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>massian</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>dx</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span style='color:#000000'><span class='cmtt-10'>:</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5020r20'></a><span class='cmr-6'>20</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5021r21'></a><span class='cmr-6'>21</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Return</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>mass</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>matrix</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>M_</span></span><span style='color:#009900'><span class='cmtt-10'>{</span></span><span style='color:#009900'><span class='cmtt-10'>ij</span></span><span style='color:#009900'><span class='cmtt-10'>}</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5022r22'></a><span class='cmr-6'>22</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5023r23'></a><span class='cmr-6'>23</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Parameters</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5024r24'></a><span class='cmr-6'>24</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>----------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5025r25'></a><span class='cmr-6'>25</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>int</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5026r26'></a><span class='cmr-6'>26</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Number</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nodes</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5027r27'></a><span class='cmr-6'>27</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>dx</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5028r28'></a><span class='cmr-6'>28</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>spacing</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5029r29'></a><span class='cmr-6'>29</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5030r30'></a><span class='cmr-6'>30</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Returns</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5031r31'></a><span class='cmr-6'>31</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>-------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5032r32'></a><span class='cmr-6'>32</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>massian_gg</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>np</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>shape</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5033r33'></a><span class='cmr-6'>33</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Matrix</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>containing</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>mass</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>matrix</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5034r34'></a><span class='cmr-6'>34</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5035r35'></a><span class='cmr-6'>35</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#FF00FF'><span class='cmtt-10'>pass</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5036r36'></a><span class='cmr-6'>36</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5037r37'></a><span class='cmr-6'>37</span></span><span style='color:#FF00FF'><span class='cmtt-10'>def</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>apply_C</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>concentration_g</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>potential_g</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>dx</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span style='color:#000000'><span class='cmtt-10'>:</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5038r38'></a><span class='cmr-6'>38</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>r</span></span><span style='color:#9400D1'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5039r39'></a><span class='cmr-6'>39</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Implements</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>the</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>term</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5040r40'></a><span class='cmr-6'>40</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5041r41'></a><span class='cmr-6'>41</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>C_</span></span><span style='color:#9400D1'><span class='cmtt-10'>{</span></span><span style='color:#9400D1'><span class='cmtt-10'>ijk</span></span><span style='color:#9400D1'><span class='cmtt-10'>}</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>c_</span></span><span style='color:#9400D1'><span class='cmtt-10'>{\</span></span><span style='color:#9400D1'><span class='cmtt-10'>alpha</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>j</span></span><span style='color:#9400D1'><span class='cmtt-10'>}</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>\</span></span><span style='color:#9400D1'><span class='cmtt-10'>Phi_k</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5042r42'></a><span class='cmr-6'>42</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5043r43'></a><span class='cmr-6'>43</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Parameters</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5044r44'></a><span class='cmr-6'>44</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>----------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5045r45'></a><span class='cmr-6'>45</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>concentration_g</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>:</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>np</span></span><span style='color:#9400D1'><span class='cmtt-10'>.</span></span><span style='color:#9400D1'><span class='cmtt-10'>ndarray</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>of</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>shape</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>(</span></span><span style='color:#9400D1'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#9400D1'><span class='cmtt-10'>,)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5046r46'></a><span class='cmr-6'>46</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Concentration</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5047r47'></a><span class='cmr-6'>47</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>potential_g</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>:</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>ndarray</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>of</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>shape</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>(</span></span><span style='color:#9400D1'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#9400D1'><span class='cmtt-10'>,)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5048r48'></a><span class='cmr-6'>48</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Electrostatic</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>potential</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5049r49'></a><span class='cmr-6'>49</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>dx</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>:</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5050r50'></a><span class='cmr-6'>50</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Grid</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>spacing</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5051r51'></a><span class='cmr-6'>51</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5052r52'></a><span class='cmr-6'>52</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Returns</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5053r53'></a><span class='cmr-6'>53</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>-------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5054r54'></a><span class='cmr-6'>54</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>C_g</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>:</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>np</span></span><span style='color:#9400D1'><span class='cmtt-10'>.</span></span><span style='color:#9400D1'><span class='cmtt-10'>ndarray</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>of</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>shape</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>(</span></span><span style='color:#9400D1'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#9400D1'><span class='cmtt-10'>,)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5055r55'></a><span class='cmr-6'>55</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Drift</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>term</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>of</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>the</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>drift</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>diffusion</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>equation</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5056r56'></a><span class='cmr-6'>56</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5057r57'></a><span class='cmr-6'>57</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#FF00FF'><span class='cmtt-10'>pass</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5058r58'></a><span class='cmr-6'>58</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5059r59'></a><span class='cmr-6'>59</span></span><span style='color:#FF00FF'><span class='cmtt-10'>def</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>compute_potential</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>charge_density_g</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>dx</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>potential_left</span></span><span style='color:#000000'><span class='cmtt-10'>=0,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>potential_right</span></span><span style='color:#000000'><span class='cmtt-10'>=0,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5060r60'></a><span class='cmr-6'>60</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>massian_gg</span></span><span style='color:#000000'><span class='cmtt-10'>=</span></span><span style='color:#000000'><span class='cmtt-10'>None</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span style='color:#000000'><span class='cmtt-10'>:</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5061r61'></a><span class='cmr-6'>61</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5062r62'></a><span class='cmr-6'>62</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Solve</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Poisson</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>equation</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>to</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>compute</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>electrostatic</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>potential</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5063r63'></a><span class='cmr-6'>63</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5064r64'></a><span class='cmr-6'>64</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Parameters</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5065r65'></a><span class='cmr-6'>65</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>----------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5066r66'></a><span class='cmr-6'>66</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>charge_density_g</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>np</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>shape</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'>,)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5067r67'></a><span class='cmr-6'>67</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Charge</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>density</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5068r68'></a><span class='cmr-6'>68</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>dx</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5069r69'></a><span class='cmr-6'>69</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>spacing</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5070r70'></a><span class='cmr-6'>70</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>potential_left</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>optional</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5071r71'></a><span class='cmr-6'>71</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Potential</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>left</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>electrode</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5072r72'></a><span class='cmr-6'>72</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>Default</span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>0)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5073r73'></a><span class='cmr-6'>73</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>potential_right</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>optional</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5074r74'></a><span class='cmr-6'>74</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Potential</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>right</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>electrode</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5075r75'></a><span class='cmr-6'>75</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>Default</span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>0)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5076r76'></a><span class='cmr-6'>76</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>massian_gg</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>np</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>shape</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5077r77'></a><span class='cmr-6'>77</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Matrix</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>containing</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Massian</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Recompute</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>if</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>None</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5078r78'></a><span class='cmr-6'>78</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>Default</span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>None</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5079r79'></a><span class='cmr-6'>79</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5080r80'></a><span class='cmr-6'>80</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Returns</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5081r81'></a><span class='cmr-6'>81</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>-------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5082r82'></a><span class='cmr-6'>82</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>potential_g</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>np</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>shape</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'>,)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5083r83'></a><span class='cmr-6'>83</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Electric</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>potential</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>on</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nodes</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5084r84'></a><span class='cmr-6'>84</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5085r85'></a><span class='cmr-6'>85</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#FF00FF'><span class='cmtt-10'>pass</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5086r86'></a><span class='cmr-6'>86</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5087r87'></a><span class='cmr-6'>87</span></span><span style='color:#FF00FF'><span class='cmtt-10'>def</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>drift_diffusion_rhs</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>concentration_g</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>potential_g</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>charge</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>dx</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5088r88'></a><span class='cmr-6'>88</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>laplacian_gg</span></span><span style='color:#000000'><span class='cmtt-10'>=</span></span><span style='color:#000000'><span class='cmtt-10'>None</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span style='color:#000000'><span class='cmtt-10'>:</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5089r89'></a><span class='cmr-6'>89</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>r</span></span><span style='color:#9400D1'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5090r90'></a><span class='cmr-6'>90</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Implements</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>the</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>term</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5091r91'></a><span class='cmr-6'>91</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5092r92'></a><span class='cmr-6'>92</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>L_</span></span><span style='color:#9400D1'><span class='cmtt-10'>{</span></span><span style='color:#9400D1'><span class='cmtt-10'>ij</span></span><span style='color:#9400D1'><span class='cmtt-10'>}</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>c_</span></span><span style='color:#9400D1'><span class='cmtt-10'>{\</span></span><span style='color:#9400D1'><span class='cmtt-10'>alpha</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>j</span></span><span style='color:#9400D1'><span class='cmtt-10'>}</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>+</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>q_</span></span><span style='color:#9400D1'><span class='cmtt-10'>\</span></span><span style='color:#9400D1'><span class='cmtt-10'>alpha</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>C_</span></span><span style='color:#9400D1'><span class='cmtt-10'>{</span></span><span style='color:#9400D1'><span class='cmtt-10'>ijk</span></span><span style='color:#9400D1'><span class='cmtt-10'>}</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>c_</span></span><span style='color:#9400D1'><span class='cmtt-10'>{\</span></span><span style='color:#9400D1'><span class='cmtt-10'>alpha</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>j</span></span><span style='color:#9400D1'><span class='cmtt-10'>}</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>\</span></span><span style='color:#9400D1'><span class='cmtt-10'>Phi_k</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5093r93'></a><span class='cmr-6'>93</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5094r94'></a><span class='cmr-6'>94</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Parameters</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5095r95'></a><span class='cmr-6'>95</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>----------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5096r96'></a><span class='cmr-6'>96</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>concentration_g</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>:</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>np</span></span><span style='color:#9400D1'><span class='cmtt-10'>.</span></span><span style='color:#9400D1'><span class='cmtt-10'>ndarray</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>of</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>shape</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>(</span></span><span style='color:#9400D1'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#9400D1'><span class='cmtt-10'>,)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5097r97'></a><span class='cmr-6'>97</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Concentration</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>of</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>the</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>species</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5098r98'></a><span class='cmr-6'>98</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>potential_g</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>:</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>ndarray</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>of</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>shape</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>(</span></span><span style='color:#9400D1'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#9400D1'><span class='cmtt-10'>,)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5099r99'></a><span class='cmr-6'>99</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Electrostatic</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>potential</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5100r100'></a><span class='cmr-6'>100</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>charge</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>:</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5101r101'></a><span class='cmr-6'>101</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Charge</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>of</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>the</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>species</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5102r102'></a><span class='cmr-6'>102</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>dx</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>:</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5103r103'></a><span class='cmr-6'>103</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Grid</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>spacing</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5104r104'></a><span class='cmr-6'>104</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>laplacian_gg</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>:</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>np</span></span><span style='color:#9400D1'><span class='cmtt-10'>.</span></span><span style='color:#9400D1'><span class='cmtt-10'>ndarray</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>of</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>shape</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>(</span></span><span style='color:#9400D1'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#9400D1'><span class='cmtt-10'>,</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#9400D1'><span class='cmtt-10'>)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5105r105'></a><span class='cmr-6'>105</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Matrix</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>containing</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>the</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Laplace</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>operator</span></span><span style='color:#9400D1'><span class='cmtt-10'>.</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Recompute</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>if</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>None</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5106r106'></a><span class='cmr-6'>106</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>(</span></span><span style='color:#9400D1'><span class='cmtt-10'>Default</span></span><span style='color:#9400D1'><span class='cmtt-10'>:</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>None</span></span><span style='color:#9400D1'><span class='cmtt-10'>)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5107r107'></a><span class='cmr-6'>107</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5108r108'></a><span class='cmr-6'>108</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Returns</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5109r109'></a><span class='cmr-6'>109</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>-------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5110r110'></a><span class='cmr-6'>110</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>rhs_g</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>:</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>np</span></span><span style='color:#9400D1'><span class='cmtt-10'>.</span></span><span style='color:#9400D1'><span class='cmtt-10'>ndarray</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>of</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>shape</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>(</span></span><span style='color:#9400D1'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#9400D1'><span class='cmtt-10'>,)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5111r111'></a><span class='cmr-6'>111</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Right</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>hand</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>side</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>(</span></span><span style='color:#9400D1'><span class='cmtt-10'>source</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>term</span></span><span style='color:#9400D1'><span class='cmtt-10'>)</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>for</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>the</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>Drift</span></span><span style='color:#9400D1'><span class='cmtt-10'>-</span></span><span style='color:#9400D1'><span class='cmtt-10'>Diffusion</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>equation</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5112r112'></a><span class='cmr-6'>112</span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'> </span></span><span style='color:#9400D1'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-5113r113'></a><span class='cmr-6'>113</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#FF00FF'><span class='cmtt-10'>pass</span></span></div>



<!-- l. 352 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>4.5 </span> <a id='x1-60004.5'></a>Zeitliche Integration</h3>
<!-- l. 353 --><p class='noindent'><span class='cmbx-12'>2 Punkte</span><br class='newline' />Die diskretisierten Nernst-Planck-Gleichungen bilden ein System gewöhnlicher
Differenzialgleichungen erster Ordnung in \(c\), wobei \(\Phi _k\) die Lösung der
Poisson-Gleichung ist, die in jedem Zeitschritt neu berechnet werden muss.
Benutzen Sie <a href='https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html'><span class='cmtt-12'>scipy.integrate.solve_ivp</span></a> um die PNP-Gleichungen zeitlich zu
integrieren. <span class='cmtt-12'>solve_ivp </span>löst das System von GDGLs mit unterschiedlichen
Verfahren, die mit dem Parameter <span class='cmtt-12'>method </span>ausgewählt werden können. Die
Standardintegrationsmethode ist ein Runge-Kutta-Verfahren mit adaptivem
Zeitschritt (<span class='cmtt-12'>RK45</span>), die gut funktionieren sollte.
</p><!-- l. 357 --><p class='indent'> <span class='cmtt-12'>solve_ivp </span>benötigt eine Funktion <span class='cmtt-12'>pnp_dcdt(time, concentration_flat)</span>,
die die zeitliche Ableitung \(\frac {\mathrm {d}c}{\mathrm {d}t}\) berechnet. Beachten Sie, dass diese Funktion einen
”flachenÄrray als Input benötigt.
</p><!-- l. 359 --><p class='indent'> <span class='cmtt-12'>solve_ivp </span>entscheidet selbst, welcher Zeitschritt für eine stabile
Zeitintegration nötig ist. Dafür muss angegeben werden, an welchen
Zeitpunkten die Konzentration ausgewertet werden soll. Die Zeitschritte, bei
denen die Konzentration ausgegeben werden sollen, werden durch <span class='cmtt-12'>t_eval</span>
festgelegt.
</p><!-- l. 361 --><p class='indent'> Im folgenden finden Sie einen Vorschlag, wie die Signatur einer Funktion, die
Ihre PNP-Gleichung propagiert, aussehen könnte.
</p>
<!-- l. 363 -->
<div class='lstlisting' id='listing-2'><span class='label'><a id='x1-6001r1'></a><span class='cmr-6'>1</span></span><span style='color:#FF00FF'><span class='cmtt-10'>def</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>integrate_pnp</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>initial_concentration_p_g</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6002r2'></a><span class='cmr-6'>2</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>initial_concentration_n_g</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6003r3'></a><span class='cmr-6'>3</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>dx</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6004r4'></a><span class='cmr-6'>4</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>maximum_time</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6005r5'></a><span class='cmr-6'>5</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>nb_output</span></span><span style='color:#000000'><span class='cmtt-10'>=2,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6006r6'></a><span class='cmr-6'>6</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>potential_left</span></span><span style='color:#000000'><span class='cmtt-10'>=0,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6007r7'></a><span class='cmr-6'>7</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>potential_right</span></span><span style='color:#000000'><span class='cmtt-10'>=0,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6008r8'></a><span class='cmr-6'>8</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>positive_charge</span></span><span style='color:#000000'><span class='cmtt-10'>=1,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6009r9'></a><span class='cmr-6'>9</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>negative_charge</span></span><span style='color:#000000'><span class='cmtt-10'>=-1,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6010r10'></a><span class='cmr-6'>10</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>**</span></span><span style='color:#000000'><span class='cmtt-10'>kwargs</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span style='color:#000000'><span class='cmtt-10'>:</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6011r11'></a><span class='cmr-6'>11</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6012r12'></a><span class='cmr-6'>12</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Integrate</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Poisson</span></span><span style='color:#009900'><span class='cmtt-10'>-</span></span><span style='color:#009900'><span class='cmtt-10'>Nernst</span></span><span style='color:#009900'><span class='cmtt-10'>-</span></span><span style='color:#009900'><span class='cmtt-10'>Planck</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>equation</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>forward</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>in</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>time</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>from</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>a</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>starting</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6013r13'></a><span class='cmr-6'>13</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>configuration</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6014r14'></a><span class='cmr-6'>14</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6015r15'></a><span class='cmr-6'>15</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Parameters</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6016r16'></a><span class='cmr-6'>16</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>----------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6017r17'></a><span class='cmr-6'>17</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>initial_concentration_p_g</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>numpy</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>shape</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'>,)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6018r18'></a><span class='cmr-6'>18</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Initial</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>concentration</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>positively</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>charges</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>species</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6019r19'></a><span class='cmr-6'>19</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>initial_concentration_n_g</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>numpy</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>shape</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'>,)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6020r20'></a><span class='cmr-6'>20</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Initial</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>concentration</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>negatively</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>charges</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>species</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6021r21'></a><span class='cmr-6'>21</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>dx</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6022r22'></a><span class='cmr-6'>22</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Grid</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>spacing</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6023r23'></a><span class='cmr-6'>23</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>maximum_time</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6024r24'></a><span class='cmr-6'>24</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Integrate</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>from</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>time</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>0</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>up</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>to</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>this</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>time</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6025r25'></a><span class='cmr-6'>25</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nb_output</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>int</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>optional</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6026r26'></a><span class='cmr-6'>26</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Frequency</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>output</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>time</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>steps</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6027r27'></a><span class='cmr-6'>27</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>Default</span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>2)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6028r28'></a><span class='cmr-6'>28</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>potential_left</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>optional</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6029r29'></a><span class='cmr-6'>29</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Potential</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>left</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>electrode</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6030r30'></a><span class='cmr-6'>30</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>Default</span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>0)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6031r31'></a><span class='cmr-6'>31</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>potential_right</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>optional</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6032r32'></a><span class='cmr-6'>32</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Potential</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>right</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>electrode</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6033r33'></a><span class='cmr-6'>33</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>Default</span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>0)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6034r34'></a><span class='cmr-6'>34</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>positive_charge</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>optional</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6035r35'></a><span class='cmr-6'>35</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Charge</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>positive</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>species</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6036r36'></a><span class='cmr-6'>36</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>Default</span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>+1)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6037r37'></a><span class='cmr-6'>37</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>negative_charge</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>optional</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6038r38'></a><span class='cmr-6'>38</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Charge</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>negative</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>species</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6039r39'></a><span class='cmr-6'>39</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>Default</span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>-1)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6040r40'></a><span class='cmr-6'>40</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6041r41'></a><span class='cmr-6'>41</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Returns</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6042r42'></a><span class='cmr-6'>42</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>-------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6043r43'></a><span class='cmr-6'>43</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>time_t</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>numpy</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>shape</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'>,)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6044r44'></a><span class='cmr-6'>44</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Times</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>at</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>which</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>output</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>is</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>reported</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6045r45'></a><span class='cmr-6'>45</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>concentration_p_tg</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>shape</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_output</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6046r46'></a><span class='cmr-6'>46</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Concentration</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>positive</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>species</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>at</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>certain</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>times</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6047r47'></a><span class='cmr-6'>47</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>concentration_n_tg</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>shape</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>(</span></span><span style='color:#009900'><span class='cmtt-10'>nb_output</span></span><span style='color:#009900'><span class='cmtt-10'>,</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>nb_nodes</span></span><span style='color:#009900'><span class='cmtt-10'>)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6048r48'></a><span class='cmr-6'>48</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Concentration</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>negative</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>species</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>at</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>certain</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>times</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6049r49'></a><span class='cmr-6'>49</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-6050r50'></a><span class='cmr-6'>50</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#FF00FF'><span class='cmtt-10'>pass</span></span></div>
<!-- l. 421 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>4.6 </span> <a id='x1-70004.6'></a>Systematische Tests der Implementierung</h3>
<!-- l. 422 --><p class='noindent'>Um sicherzustellen, dass die Implementation korrekt ist, werden wir erstmal
einfache Sonderfälle betrachten. Dabei steigert sich die Komplexität Schritt
für Schritt. Sie können so schon einen Teil des Codes testen, bevor alles
implementiert ist.



</p><!-- l. 424 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>4.6.1 </span> <a id='x1-80004.6.1'></a>Nernst-Planck-Gleichung mit \(q_\alpha =0\), die Diffusionsgleichung</h4>
<!-- l. 425 --><p class='noindent'><span class='cmbx-12'>2 Punkte</span><br class='newline' />Wir betrachten nur eine Spezies, die Ladungsneutral ist. Damit wird die
Poisson-Nernst-Planck-Gleichung zur altbekannten Diffusionsgleichung:
</p><!-- l. 428 --><p class='indent'>
</p>
<div class='math-display'>
<img alt='Mij˙cαj(x,t) = Lijcαj(x, t)
' class='math-display' src='ex04_zeitpropagation0x.svg' /></div>
<!-- l. 430 --><p class='indent'> <span class='cmbx-12'>Eine Spezies</span><br class='newline' />Durch die Ränder des Simulationsgebiets fließt kein Stoff, d.h. wir betrachten
homogene Neumann-Randbedingungen. Vergewissern Sie sich, dass \(c(x, t) = c^\infty + \Delta c \exp \left [-D\left (\frac {2\pi }{L}\right )^2 t \right ] \cos (2 \pi x /L)\) für
eine Initialverteilung \(c(x, 0) = c^\infty + \Delta c \cos (2 \pi x /L)\) und benannte Randbedingungen eine Lösung der
Diffusionsgleichung \(\dot c = D \frac {\partial ^2 c}{\partial x ^ 2}\) ist. Achten Sie darauf, dass \(\Delta c &lt; c^\infty \). (Warum ist das wichtig?)
</p><!-- l. 433 --><p class='indent'> Zeigen Sie, dass Ihr Modell mit der analytischen Lösung der Diffusionsgleichung
übereinstimmt. Stellen Sie dafür die analytische Lösung und einen Schnitt der
numerischen Lösung bei den Zeitschritten \(t = 0.\), \(t=0.05\) und \(t=0.1\) dar. Verwenden Sie dabei einen
Plattenabstand von \(L=2\).
</p>
<div class='framedenv' id='shaded*-1'>
<!-- l. 435 --><p class='noindent'><span class='underline'><span class='cmbx-12'>Anmerkung:</span></span> Auf Grund der <a href='https://de.wikipedia.org/wiki/CFL-Zahl'>CFL</a>-Bedindung benötigen feinere Gitter kleinere
Zeitschritte und rechnen damit wesentlich länger. \(10\)-\(20\) Knoten reichen vollkommen. </p></div>
<!-- l. 439 --><p class='indent'> <span class='cmbx-12'>Zwei Spezies</span><br class='newline' />Lösen Sie ganz einfach zwei entkoppelte Diffusionsleichungen. Es geht
nur darum, zu testen, ob die Implementation von zwei Spezies fehlerfrei



funktioniert.
</p><!-- l. 451 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>4.6.2 </span> <a id='x1-90004.6.2'></a>Teilchen driften unter dem Einfluss eines elektrischen Feldes</h4>
<!-- l. 452 --><p class='noindent'><span class='cmbx-12'>2 Punkte</span><br class='newline' />Legen Sie einen Potenzialunterschied zwischen der linken und rechten
Platte an und überprüfen Sie, dass sich geladene Teilchen in die richtige
Richtung bewegen. Sie können eine Dirac-ähnliche Anfangskonzentration
verwenden und zeigen Sie, wie sich diese verschiebt. Es kann sein, dass Sie
die effektive Ladung ihrer Ionen erhöhen müssen, um diesen Effekt zu
sehen.
</p><!-- l. 463 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>4.6.3 </span> <a id='x1-100004.6.3'></a>Spezies mit gleicher Ladung stoßen sich ab</h4>
<!-- l. 464 --><p class='noindent'><span class='cmbx-12'>2 Punkte</span><br class='newline' />Zeigen Sie, dass sich Spezies mit gleicher Ladung auch abstoßen. Nutzen Sie zwei
Dirac-ähnliche Funktionen als Anfangsbedingungen und kein angelegtes
elektrisches Feld.
</p><!-- l. 475 --><p class='noindent'>
</p>
<h4 class='subsectionHead'><span class='titlemark'>4.6.4 </span> <a id='x1-110004.6.4'></a>Spezies mit Ladungen unterschiedlichen Vorzeichens ziehen sich
an</h4>
<!-- l. 476 --><p class='noindent'><span class='cmbx-12'>1 Punkte</span><br class='newline' />Zeigen Sie, dass zwei Spezies mit unterschiedlicher Ladung sich anziehen. Starten
Sie mit zwei Spezies mit unterschiedlicher Ladung und keinem angelegten
elektrischen Feld. Zwei versetzte Dirac-Peaks in der Konzentration sollten sich
anziehen.
</p><!-- l. 487 --><p class='noindent'>



</p>
<h4 class='subsectionHead'><span class='titlemark'>4.6.5 </span> <a id='x1-120004.6.5'></a>Validieren Sie Ihren Code quantitativ gegen eine bekannte analytische
Lösung</h4>
<!-- l. 488 --><p class='noindent'><span class='cmbx-12'>2 Punkte</span><br class='newline' />Für diesen (um \(x=0\)) symmetrischen Fall lässt sich die nichtlineare
Poisson-Boltzmann-Gleichung über den Ansatz \begin {equation} \Phi (x) = \Phi _0 + \frac {k_B T}{ q_e} \ln {\cos ^2(K x)} \end {equation}
lösen, wobei \(\Phi _0\) und \(K\) noch zu bestimmen sind. Für das Erfüllen der
Differenzialgleichung muss \begin {equation} \Phi _0 = - \frac {k_B T}{q_e} \ln \Big ( \frac {2 k_B T \varepsilon }{q_e^2 c_{\infty }} K^2 \Big ) \end {equation}
gelten. Erfüllen der Potential-Randbedingungung \(\Phi (L/2) = \Phi _1\) liefert eine transzendente
Gleichung für \(K\), \begin {equation} \cos ^2 \Big (\frac {K L }{2}\Big ) - \exp \Big ( \frac {q_e}{k_B T} \Phi _1 \Big ) \frac {2 k_B T \varepsilon }{q_e^2 c_\infty } K^2 = 0, \end {equation}
die numerisch gelöst werden muss. (Unten finden Sie eine Funktion, die
<a href='https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.root_scalar.html'><span class='cmtt-12'>scipy.optimize.root_scalar</span></a> nutzt um diese Gleichung zu lösen.)
</p><!-- l. 503 --><p class='indent'> \(c_{\infty }\) ist die Konzentration des Bades mit elektrischem Potential \(\Phi = 0\), das im
Gleichgewicht mit dem betrachteten Behälter steht. Da das elektrische Potential
am linken und am rechten Rand in unserer Simulation auch gleich Null ist, muss
dort die Gleichgewichtskonzentration gleich \(c_\infty \) sein. Messen Sie diese Konzentration
und setzen Sie \(c_\infty \) auf diesen Wert.
</p><!-- l. 506 --><p class='indent'> Zeigen Sie, dass die numerische Lösung für große Zeitschritte mit der
analytischen Lösung übereinstimmt.
</p>
<!-- l. 508 -->
<div class='lstlisting' id='listing-3'><span class='label'><a id='x1-12001r1'></a><span class='cmr-6'>1</span></span><span style='color:#FF00FF'><span class='cmtt-10'>def</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>poisson_boltzmann_symmetric</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>x</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>wall_distance</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>potential_wall</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span style='color:#000000'><span class='cmtt-10'>:</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12002r2'></a><span class='cmr-6'>2</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12003r3'></a><span class='cmr-6'>3</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Solution</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Poisson</span></span><span style='color:#009900'><span class='cmtt-10'>-</span></span><span style='color:#009900'><span class='cmtt-10'>Boltzmann</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>equation</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>for</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>1</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>species</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12004r4'></a><span class='cmr-6'>4</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>between</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>two</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>plates</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>with</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>fixed</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>potential</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12005r5'></a><span class='cmr-6'>5</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12006r6'></a><span class='cmr-6'>6</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>The</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>solution</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>is</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>connected</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>with</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>a</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>bath</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>with</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12007r7'></a><span class='cmr-6'>7</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>potential</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>0</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>and</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>concentration</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>‘</span></span><span style='color:#009900'><span class='cmtt-10'>concentration_bath</span></span><span style='color:#009900'><span class='cmtt-10'>‘.</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12008r8'></a><span class='cmr-6'>8</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12009r9'></a><span class='cmr-6'>9</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Parameters</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12010r10'></a><span class='cmr-6'>10</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>----------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12011r11'></a><span class='cmr-6'>11</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>x</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>array_like</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12012r12'></a><span class='cmr-6'>12</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Position</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>in</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>units</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>debye</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>length</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12013r13'></a><span class='cmr-6'>13</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>wall_distance</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12014r14'></a><span class='cmr-6'>14</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Wall</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>distance</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>in</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>units</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>debye</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>length</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12015r15'></a><span class='cmr-6'>15</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>potential_wall</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>float</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12016r16'></a><span class='cmr-6'>16</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Electric</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>potential</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>at</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>wall</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>in</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>units</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>thermal</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>voltage</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12017r17'></a><span class='cmr-6'>17</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12018r18'></a><span class='cmr-6'>18</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>Returns</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12019r19'></a><span class='cmr-6'>19</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>-------</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12020r20'></a><span class='cmr-6'>20</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>potential_g</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>:</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>numpy</span></span><span style='color:#009900'><span class='cmtt-10'>.</span></span><span style='color:#009900'><span class='cmtt-10'>ndarray</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12021r21'></a><span class='cmr-6'>21</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>The</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>potential</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>evaluated</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>at</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>x</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>in</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>units</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>of</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>thermal</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>voltage</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12022r22'></a><span class='cmr-6'>22</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>"""</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12023r23'></a><span class='cmr-6'>23</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#FF00FF'><span class='cmtt-10'>from</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>scipy</span></span><span style='color:#000000'><span class='cmtt-10'>.</span></span><span style='color:#000000'><span class='cmtt-10'>optimize</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#FF00FF'><span class='cmtt-10'>import</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>root_scalar</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12024r24'></a><span class='cmr-6'>24</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12025r25'></a><span class='cmr-6'>25</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>#</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>solve</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>the</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>transcendental</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>equation</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>for</span></span><span style='color:#009900'><span class='cmtt-10'> </span></span><span style='color:#009900'><span class='cmtt-10'>K</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12026r26'></a><span class='cmr-6'>26</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>L</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>=</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>wall_distance</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12027r27'></a><span class='cmr-6'>27</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>sol</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>=</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>root_scalar</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12028r28'></a><span class='cmr-6'>28</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#FF00FF'><span class='cmtt-10'>lambda</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>K</span></span><span style='color:#000000'><span class='cmtt-10'>:</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12029r29'></a><span class='cmr-6'>29</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>np</span></span><span style='color:#000000'><span class='cmtt-10'>.</span></span><span style='color:#000000'><span class='cmtt-10'>cos</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>K</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>*</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>L</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>/</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>2)</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>**</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>2</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12030r30'></a><span class='cmr-6'>30</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>-</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>4</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>*</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>K</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>**</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>2</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>*</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>np</span></span><span style='color:#000000'><span class='cmtt-10'>.</span></span><span style='color:#000000'><span class='cmtt-10'>exp</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>potential_wall</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span style='color:#000000'><span class='cmtt-10'>,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12031r31'></a><span class='cmr-6'>31</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>x0</span></span><span style='color:#000000'><span class='cmtt-10'>=</span></span><span style='color:#000000'><span class='cmtt-10'>np</span></span><span style='color:#000000'><span class='cmtt-10'>.</span></span><span style='color:#000000'><span class='cmtt-10'>pi</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>/</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>L</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>*</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>0.9999,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12032r32'></a><span class='cmr-6'>32</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>x1</span></span><span style='color:#000000'><span class='cmtt-10'>=</span></span><span style='color:#000000'><span class='cmtt-10'>np</span></span><span style='color:#000000'><span class='cmtt-10'>.</span></span><span style='color:#000000'><span class='cmtt-10'>pi</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>/</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>L</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>*</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>0.0001,</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12033r33'></a><span class='cmr-6'>33</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12034r34'></a><span class='cmr-6'>34</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>assert</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>sol</span></span><span style='color:#000000'><span class='cmtt-10'>.</span></span><span style='color:#000000'><span class='cmtt-10'>converged</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12035r35'></a><span class='cmr-6'>35</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12036r36'></a><span class='cmr-6'>36</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>_K</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>=</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>sol</span></span><span style='color:#000000'><span class='cmtt-10'>.</span></span><span style='color:#000000'><span class='cmtt-10'>root</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12037r37'></a><span class='cmr-6'>37</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12038r38'></a><span class='cmr-6'>38</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#FF00FF'><span class='cmtt-10'>return</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>(-</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>np</span></span><span style='color:#000000'><span class='cmtt-10'>.</span></span><span style='color:#000000'><span class='cmtt-10'>log</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>_K</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>**</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>2</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>*</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>4)</span></span><span class='cmtt-10'> </span><br />
<span class='label'><a id='x1-12039r39'></a><span class='cmr-6'>39</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>+</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>np</span></span><span style='color:#000000'><span class='cmtt-10'>.</span></span><span style='color:#000000'><span class='cmtt-10'>log</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>np</span></span><span style='color:#000000'><span class='cmtt-10'>.</span></span><span style='color:#000000'><span class='cmtt-10'>cos</span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>_K</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>*</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>(</span></span><span style='color:#000000'><span class='cmtt-10'>x</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>**</span></span><span style='color:#000000'><span class='cmtt-10'> </span></span><span style='color:#000000'><span class='cmtt-10'>2)</span></span><span style='color:#000000'><span class='cmtt-10'>)</span></span></div>
<!-- l. 559 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>4.7 </span> <a id='x1-130004.7'></a>Zyklische Anregung</h3>
<!-- l. 560 --><p class='noindent'>Wir wollen uns jetzt der Modellierung eines Kondensators unter zyklischer
Anwendung widmen. Modifizieren Sie Ihren Code so, dass Sie das Potential auf
der rechten Seite des Kondensators zeitlich variieren können. Regen
Sie Ihr System nun mit einer Dreiecksanregung an. Mit der Funktion
<a href='https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.sawtooth.html'><span class='cmtt-12'>scipy.signal.sawtooth</span></a> können Sie direkt ein solchen Signal erzeugen. Das
folgende Bild zeigt ein entsprechendes Anregungsprofil.
</p><!-- l. 562 --><p class='indent'> <img alt='PIC' src='sawtooth_signal-.png' />
</p><!-- l. 564 --><p class='indent'> Zeigen Sie nun die Ionenkonzentration und den Potentialverlauf über den
Kondensator als Funktion der Zeit. (Sie können hier auch gerne ein Video von
machen!) Nutzen Sie hierfür zunächst eine Länge von \(L=1\) (also dem \(1\)-fachen der



Debye-Länge) und eine Periode von \(T=1\). Die Anfangkonzentration darf konstant sein
und \(1\) betragen. Die Amplitude der Anregung sollte auch \(1\) sein. Achten Sie darauf,
dass zum Anfang der Simulation das Potential auf beiden Elektroden identisch
ist.
</p><!-- l. 566 --><p class='indent'> Zeigen Sie die Fälle: </p>
<ul class='itemize1'>
<li class='itemize'>\(L=1\), \(T=1\)
</li>
<li class='itemize'>\(L=10\), \(T=1\)
</li>
<li class='itemize'>\(L=10\), \(T=10\)
</li>
<li class='itemize'>\(L=10\), \(T=100\)</li></ul>
<!-- l. 574 --><p class='indent'> Wie unterscheiden sich diese Fälle und warum? Interessant sind insbesondere
die Ionenkonzentrationen und Potentialverläufe bei den maximalen und
minmialen Spannungen (Potentialdifferenzen).
</p>
<div class='framedenv' id='shaded*-1'>
<!-- l. 576 --><p class='noindent'><span class='underline'><span class='cmbx-12'>Anmerkung:</span></span> </p>
<ul class='itemize1'>
<li class='itemize'>Sie müssen die Referenzlänge \(1\), also die Debye-Länge, mit ein
paar Gitterpunkten diskretisieren. Dies ist nötig weil typische
Konzentrationsabfälle über diese Länge stattfinden und Sie diese
noch erfassen müssen.
</li>
<li class='itemize'>Die Rechnungen mit \(T=100\) werden vermutlich länger rechnen.</li></ul>
</div>



<!-- l. 594 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>4.8 </span> <a id='x1-140004.8'></a>Cyclovoltammogramm</h3>
<!-- l. 595 --><p class='noindent'><span class='cmbx-12'>5 Punkte</span><br class='newline' />Wir wollen uns nun in dieser letzten Aufgabe der Berechnung eines
Cyclovoltammogramms (CVs) widmen. Hierzu wird der Ladung als Funktion der
Spannung geplottet. Wie lautet der Ausdruck für die Ladung auf den
Kondensatorplatten? Implementieren Sie diesen in eine Hilfsfunktion.
</p>
<div class='framedenv' id='shaded*-1'>
<!-- l. 598 --><p class='noindent'><span class='underline'><span class='cmbx-12'>Anmerkung:</span></span> Ein CV ist eigentlich Strom als Funktion der Spannung,
wir schauen uns hier aber die Ladung an. Sie können den Strom
natürlich als zeitliche Veränderung der Ladung, also als Ableitung eines
Ladungs-Spannungs-Diagramms, bestimmen. </p></div>
<!-- l. 602 --><p class='indent'> Implementieren Sie nun eine Funktion, die Ihnen ein Cyclovoltammogramm
für Ihren Kondensator ausrechnet.
</p><!-- l. 604 --><p class='indent'> Berechnen Sie die CVs für die oben genannten Parameter. Es macht Sinn die
CVs über 5 Perioden aufzunehmen. Was sehen Sie und warum?
</p><!-- l. 626 --><p class='noindent'>
</p>
<h3 class='sectionHead'><span class='titlemark'>4.9 </span> <a id='x1-150004.9'></a>Dünnbesetzte Algorithmik</h3>
<!-- l. 627 --><p class='noindent'><span class='cmbx-12'>0 Punkte</span><br class='newline' />Schreiben Sie Ihre Funktion so um, dass sie dünnbesetzte Arithmetik aus dem
Paket <a href='https://docs.scipy.org/doc/scipy/reference/sparse.html'><span class='cmtt-12'>scipy.sparse</span></a> nutzt. Dies reduziert die Komplexität der Lösung eines
linearen Gleichungssystem von \(\mathcal {O}(N^2)\) auf \(\mathcal {O}(N)\). D.h. wenn Sie Ihre Gitterpunkte
verdoppeln, sollte der Code dann nur doppelt (und nicht viermal) so langsam
laufen.
</p>
<div class='framedenv' id='shaded*-1'>
<!-- l. 630 --><p class='noindent'><span class='underline'><span class='cmbx-12'>Anmerkung:</span></span> Nutzen Sie das “compressed sparse row (CSR)” Format
<span class='obeylines-h'><span class='verb'><span class='cmtt-12'>scipy.sparse.csr_matrix</span></span></span>. Für die Lösung linearer Gleichungssysteme
müssen Sie dann <a href='https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.linalg.spsolve.html'><span class='cmtt-12'>scipy.sparse.linalg.spsolve</span></a> nutzen. </p></div>




